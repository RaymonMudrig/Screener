<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDX Stock Screener</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cline x1='2' y1='20' x2='2' y2='14'/%3E%3Cline x1='7' y1='20' x2='7' y2='10'/%3E%3Cline x1='12' y1='20' x2='12' y2='6'/%3E%3Cline x1='17' y1='20' x2='17' y2='12'/%3E%3Cline x1='22' y1='20' x2='22' y2='8'/%3E%3Cpath d='M2 4l5 5 5-5 5 5 5-5'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/lightweight-charts@3.8.0/dist/lightweight-charts.standalone.production.js"></script>
</head>
<body>
    <div class="container">
        <!-- Top Panel -->
        <div class="top-panel">
            <select id="pattern-dropdown" class="pattern-select">
                <option value="">Loading patterns...</option>
            </select>

            <button id="run-btn" class="btn btn-primary" disabled>
                ‚ñ∂ Run
            </button>
            <button id="add-pattern-btn" class="btn btn-success">
                ‚ûï Add
            </button>
            <button id="edit-pattern-btn" class="btn btn-secondary" disabled>
                ‚úèÔ∏è Edit
            </button>
            <button id="delete-pattern-btn" class="btn btn-danger" disabled>
                üóëÔ∏è Delete
            </button>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Tab Bar -->
            <div class="tab-bar">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="pattern">Pattern Results</button>
                    <!-- Stock tabs will be added dynamically -->
                </div>
                <div class="stock-input-container">
                    <input type="text" id="stock-input" class="stock-input-compact"
                           placeholder="Stock code" maxlength="6">
                    <button id="analyze-btn" class="btn btn-primary btn-compact">üîç</button>
                </div>
            </div>

            <!-- Tab Contents -->
            <div class="tab-contents">
                <!-- Pattern Tab Content -->
                <div class="tab-content active" id="pattern-tab">

                    <!-- Pattern Info -->
                    <div id="pattern-info" class="pattern-info">
                        <div class="info-header">
                            <div class="info-left">
                                <strong id="pattern-name"></strong>
                                <span id="pattern-category" class="badge"></span>
                            </div>
                            <div class="info-right">
                                <span id="pattern-description" class="info-description"></span>
                            </div>
                        </div>
                        <div class="criteria-grid">
                            <div>
                                <strong>Technical:</strong>
                                <div id="details-technical" class="criteria-list"></div>
                            </div>
                            <div>
                                <strong>Fundamental:</strong>
                                <div id="details-fundamental" class="criteria-list"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Loading Indicator -->
                    <div id="loading" class="loading" style="display: none;">
                        <div class="spinner"></div>
                        <p>Screening stocks...</p>
                    </div>

                    <!-- Results -->
                    <div class="results-header">
                        <span id="results-count"></span>
                        <span id="execution-time"></span>
                    </div>
                    <div id="results-container" class="results-container">
                        <div class="placeholder">
                            <p>üëÜ Select a pattern and click "Run" to see results</p>
                        </div>
                    </div>
                </div>

                <!-- Stock Analyzer Tabs (dynamically created) -->
            </div>
        </div>

        <!-- Custom Pattern Editor Modal (Hidden - Used as template only) -->
        <div id="pattern-editor-modal" class="modal" style="display: none !important;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="editor-title">Create Custom Pattern</h3>
                    <button id="close-editor" class="btn-close">√ó</button>
                </div>

                <div class="modal-body">
                    <!-- Basic Info -->
                    <div class="form-section">
                        <h4>Basic Information</h4>

                        <div class="form-group">
                            <label for="pattern-name-input">Pattern Name *</label>
                            <input type="text" id="pattern-name-input" class="form-input" placeholder="My Custom Strategy" required>
                        </div>

                        <div class="form-group">
                            <label for="pattern-category-input">Category *</label>
                            <select id="pattern-category-input" class="form-input" required>
                                <option value="custom">Custom</option>
                                <option value="value">Value</option>
                                <option value="growth">Growth</option>
                                <option value="quality">Quality</option>
                                <option value="health">Financial Health</option>
                                <option value="technical">Technical</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="pattern-description-input">Description</label>
                            <textarea id="pattern-description-input" class="form-input" rows="3" placeholder="Describe your screening strategy..."></textarea>
                        </div>
                    </div>

                    <!-- Technical Signals -->
                    <div class="form-section">
                        <h4>Technical Signals</h4>
                        <p class="section-hint">Select which technical signals to look for</p>

                        <div class="signals-grid" id="signals-grid">
                            <!-- Will be populated by JavaScript -->
                        </div>

                        <div class="form-group">
                            <label for="min-signal-strength">Minimum Signal Strength (0-100)</label>
                            <input type="number" id="min-signal-strength" class="form-input" min="0" max="100" value="70">
                        </div>
                    </div>

                    <!-- Fundamental Metrics -->
                    <div class="form-section">
                        <h4>Fundamental Metrics</h4>
                        <p class="section-hint">Set ranges for fundamental metrics</p>

                        <div class="metrics-container" id="metrics-container">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button id="cancel-editor-btn" class="btn btn-secondary">Cancel</button>
                    <button id="save-pattern-btn" class="btn btn-primary">Save Pattern</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
